{% extends "flm::dialog-window.twig" %}

{% block content %}
    {{ window.pathBrowser(basename(selectedTarget), 'File', "", "disabled readonly") }}
    <div class="ratio" style="resize: both; overflow: auto; min-height:480px; max-height: 700px; min-width: 700px;">
        <div class="flm-media-image-viewer" style="min-height:480px; overflow:scroll">
            <figure class="zoom" onmousemove="zoom(event)" style="
                    width: 100%;
                    background-image: url('{{ mediaEntry.file  }}')">
                <img src="{{ mediaEntry.file  }}" />
            </figure>
        </div>
    </div>
{% endblock %}
{% block scripts %}
    <style>
        figure.zoom {
            background-position: 50% 50%;
            position: relative;
            width: 500px;
            overflow: hidden;
            cursor: zoom-in;
        }
        figure.zoom img:hover {
            opacity: 0;
        }
        figure.zoom img {
            transition: opacity .5s;
            display: block;
            width: 100%;
        }
    </style>
    <script>
        var offsetX, offsetY;
        offsetX = offsetY = 0;

        function zoom(e)
        {
                var zoomer = e.currentTarget;
                $type(e.offsetX) ? offsetX = e.offsetX : offsetX = e.touches[0].pageX;
                $type(e.offsetY) ? offsetY = e.offsetY : offsetX = e.touches[0].pageX;
                var x = offsetX/zoomer.offsetWidth*100;
                var y = offsetY/zoomer.offsetHeight*100;
                zoomer.style.backgroundPosition = x + '% ' + y + '%';
        }

        flm.media.onPlayMedia((e, mediaEntry) => {
            if(mediaEntry.isImage)
            {
                let viewer = $(".flm-media-image-viewer");
                viewer.find('img').attr('src', mediaEntry.file);
                viewer.find('figure').css('background-image', `url(${mediaEntry.file})`);
            }
        });
    </script>

{% endblock %}

{% block buttons %}

{% endblock %}